#!/bin/bash

# Functions

# updateWal()
#
# Update pywal to use current desktop background
# image as color scheeme source
#
function updateWal()
{
    currentWallpaper=$(gsettings get org.gnome.desktop.background picture-uri-dark | sed "s/'//g") &&
    [ -f "$currentWallpaper" ] &&
    wal -c &&
    wal -q --backend="$(cat ~/.lastColorBackend.txt)" -i "$currentWallpaper"
}

# Options
set -o vi

# Environment Vars
PATH="${PATH}:${HOME}/.darling"
PATH="${PATH}:${HOME}/.local/bin"

# PS1 #
git_branch() {
  if [ -d .git ]; then
    branch=$(git rev-parse --abbrev-ref HEAD 2>/dev/null)
    if [ $? -eq 0 ]; then
      echo -e "\033[0m\033[34;97m ($branch)\033[0m"
    fi
  fi
}

git_status() {
  if [ -d .git ]; then
    if git rev-parse --git-dir >/dev/null 2>&1; then
      if [ -n "$(git status --porcelain)" ]; then
        echo -e "\033[1;33m (unsaved) \033[0m"
      fi
    fi
  fi
}

#  Previous: PS1='\[\e[1;0m\]\[\e[1;36m\]\d \[\e[1;33m\]\t \[\e[34;94m\]\u@\h:\[\e[1;0m\] \[\e[34;97m\]\w\[\e[34;93m\] [\!] $(git_branch)$(git_status)\[\e[1;33m\]\n $ \[\e[34;35m\]'
PS1='\n\[\e[1;0m\]\[\e[34;93m\] [\!] \[\e[34;94m\]\u@\h:\[\e[1;0m\] \[\e[34;35m\]\w $(git_branch)$(git_status)\n\[\e[34;33m\]\n \[\e[33;96m\]\d\[\e[33;0m\] \[\e[1;33m\]\t \[\e[34;94m\]$\[\e[34;0m\] \[\e[34;96m\]'

# Vars
alias map="mapscii"
alias tmap="telnet mapscii.me"
alias cdswp="cd /home/darling/.local/share/nvim/swap/"
alias c='clear'
alias gfav='gtav ":)"'
alias ls='exa -laF'
alias more='less -R'
alias less='less -R'
alias q='exit'
alias r="history -c && reset"
alias tls='tmux ls'
alias tna='tmux attach -t'
alias tns='tmux new -s'
alias voa='xargs --delimiter "\\n" --arg-file="${HOME}/vimfilelist" nvim --'
alias gst='git status'
alias gdf='git diff'
alias gds='git diff --stat'
alias gpu='printf "\n\e[0m\e[105m\e[30mAre you sure that you want to push your changes to github? (y|n)\e[0m\n"; read c; [ "${c}" == "y" ] && git push -u'
alias gs='echo "gs is disabled via an alias defined in ~/.darlingrc"'
alias cmx='cmatrix -su 11'
alias cat='bat --style plain'
#alias mylinux='/usr/bin/git --git-dir="${HOME}/.MyLinux" --work-tree="${HOME}"'
alias uts='date +"%s"'
alias edrc='vim ${HOME}/.darlingrc'
alias sdrc='source ${HOME}/.darlingrc'
alias rbytes='head -c 5M /dev/urandom | sha1sum | sed "s/-//g" | sed "s/ //g"'
alias myip='ifconfig wlo1 | grep "inet "'
alias smon='sudo tcpdump -i'
alias chess='telnet freechess.org'
alias sshDarlingArchRoot='ssh root@45.79.172.110'
alias sshDarlingArchDarling='ssh darling@45.79.172.110'

# Make sure colors match background image

[ -z "$TMUX" ] && updateWal;

# show todo list
# echo "Todo: "
# echo
# td list
# echo
# echo "To view todo: td list | To add todo: td add \"todo\" | To remove todo: td done <int>"
#
